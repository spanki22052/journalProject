# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API —Å TanStack Query

## ‚úÖ –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `@tanstack/react-query` - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–µ—Ä–≤–µ—Ä–∞
- `@tanstack/react-query-devtools` - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- `axios` - HTTP –∫–ª–∏–µ–Ω—Ç

### 2. API –∫–ª–∏–µ–Ω—Ç (`src/shared/api/client.ts`)

- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π axios —Å –±–∞–∑–æ–≤—ã–º URL
- –ò–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ development —Ä–µ–∂–∏–º–µ

### 3. –¢–∏–ø—ã API (`src/shared/api/types.ts`)

- –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤
- –¢–∏–ø—ã –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤, —á–µ–∫–ª–∏—Å—Ç–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- –¢–∏–ø—ã –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### 4. API —Å–µ—Ä–≤–∏—Å—ã

- `objectsApi` - —Ä–∞–±–æ—Ç–∞ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
- `checklistsApi` - —Ä–∞–±–æ—Ç–∞ —Å —á–µ–∫–ª–∏—Å—Ç–∞–º–∏
- `organizationsApi` - —Ä–∞–±–æ—Ç–∞ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏

### 5. TanStack Query –ø—Ä–æ–≤–∞–π–¥–µ—Ä (`src/app/providers/withQuery.tsx`)

- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π QueryClient —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- DevTools –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 6. Entities —Å API —Ö—É–∫–∞–º–∏

- `@entities/object` - —Ö—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
- `@entities/checklist` - —Ö—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —á–µ–∫–ª–∏—Å—Ç–∞–º–∏
- `@entities/organization` - —Ö—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏:

```env
# API Configuration
VITE_API_BASE_URL=http://localhost:3001/api
VITE_API_TIMEOUT=10000

# Development
VITE_NODE_ENV=development
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```typescript
import { useObjects, useCreateObject, useUpdateObject } from '@entities/object';
import { useChecklistsByObject } from '@entities/checklist';

function ObjectsPage() {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
  const { data: objects, isLoading, error } = useObjects({
    page: 1,
    limit: 10,
  });

  // –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
  const createObject = useCreateObject();

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
  const updateObject = useUpdateObject();

  const handleCreateObject = async () => {
    try {
      await createObject.mutateAsync({
        name: '–ù–æ–≤—ã–π –æ–±—ä–µ–∫—Ç',
        startDate: '2024-01-01',
        endDate: '2024-12-31',
        type: 'project',
        assignee: '–ò–≤–∞–Ω–æ–≤ –ò.–ò.',
      });
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞:', error);
    }
  };

  if (isLoading) return <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>;
  if (error) return <div>–û—à–∏–±–∫–∞: {error.message}</div>;

  return (
    <div>
      {objects?.data.map(object => (
        <div key={object.id}>{object.name}</div>
      ))}
    </div>
  );
}
```

### 3. –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—É–∫–∏

#### –û–±—ä–µ–∫—Ç—ã (`@entities/object`)

- `useObjects(params?)` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤
- `useObject(id)` - –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ ID
- `useObjectsByParent(parentId)` - –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –ø–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É ID
- `useCreateObject()` - —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç
- `useUpdateObject()` - –æ–±–Ω–æ–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç
- `useDeleteObject()` - —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç
- `useUpdateObjectProgress()` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
- `useToggleObjectExpanded()` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ

#### –ß–µ–∫–ª–∏—Å—Ç—ã (`@entities/checklist`)

- `useChecklists(params?)` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —á–µ–∫–ª–∏—Å—Ç–æ–≤
- `useChecklist(id)` - –ø–æ–ª—É—á–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç –ø–æ ID
- `useChecklistsByObject(objectId)` - –ø–æ–ª—É—á–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç—ã –æ–±—ä–µ–∫—Ç–∞
- `useCreateChecklist()` - —Å–æ–∑–¥–∞—Ç—å —á–µ–∫–ª–∏—Å—Ç
- `useUpdateChecklist()` - –æ–±–Ω–æ–≤–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç
- `useDeleteChecklist()` - —É–¥–∞–ª–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç
- `useChecklistItems(checklistId)` - –ø–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —á–µ–∫–ª–∏—Å—Ç–∞
- `useCreateChecklistItem()` - —Å–æ–∑–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç —á–µ–∫–ª–∏—Å—Ç–∞
- `useUpdateChecklistItem()` - –æ–±–Ω–æ–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç —á–µ–∫–ª–∏—Å—Ç–∞
- `useDeleteChecklistItem()` - —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç —á–µ–∫–ª–∏—Å—Ç–∞
- `useToggleChecklistItem()` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞

#### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (`@entities/organization`)

- `useOrganizations(params?)` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- `useOrganization(id)` - –ø–æ–ª—É—á–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –ø–æ ID
- `useCreateOrganization()` - —Å–æ–∑–¥–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
- `useUpdateOrganization()` - –æ–±–Ω–æ–≤–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
- `useDeleteOrganization()` - —É–¥–∞–ª–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
- `useOrganizationWorks(organizationId)` - –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- `useOrganizationWork(organizationId, workId)` - –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ ID
- `useCreateOrganizationWork()` - —Å–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—Ç—É
- `useUpdateOrganizationWork()` - –æ–±–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É
- `useDeleteOrganizationWork()` - —É–¥–∞–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É
- `useUpdateOrganizationWorkProgress()` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–±–æ—Ç—ã

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### QueryClient –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- `staleTime: 5 –º–∏–Ω—É—Ç` - –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–≤–µ–∂–∏–º–∏ 5 –º–∏–Ω—É—Ç
- `gcTime: 10 –º–∏–Ω—É—Ç` - –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫—ç—à–µ 10 –º–∏–Ω—É—Ç
- `refetchOnWindowFocus: false` - –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –æ–∫–Ω–∞
- `retry: 3 –ø–æ–ø—ã—Ç–∫–∏` - –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### Axios –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- –ë–∞–∑–æ–≤—ã–π URL: `http://localhost:3001/api`
- –¢–∞–π–º–∞—É—Ç: 10 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 401, 403, 404, 500

## üêõ –û—Ç–ª–∞–¥–∫–∞

### DevTools

–í development —Ä–µ–∂–∏–º–µ –¥–æ—Å—Ç—É–ø–Ω—ã React Query DevTools –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫—ç—à–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í development —Ä–µ–∂–∏–º–µ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

- üöÄ API Request - –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ API Response - —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- ‚ùå API Error - –æ—à–∏–±–∫–∏

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞–π—Ç–µ `.env.local` —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ API
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä
3. –ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—É–∫–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ localStorage)
5. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤ UI

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [TanStack Query –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://tanstack.com/query/latest)
- [Axios –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://axios-http.com/)
- [React Query DevTools](https://tanstack.com/query/latest/docs/react/devtools)
